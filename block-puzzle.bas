10 PRINT "BLOCK PUZZLE"
20 PRINT "INSTRUCTIONS:"
30 PRINT "Use arrow keys to move blocks"
40 PRINT "Fill each row or column to clear it"
50 PRINT "Press Q to quit"
60 PRINT
70 DIM GRID(10,10)
80 FOR I = 1 TO 10
90   FOR J = 1 TO 10
100    GRID(I,J) = 0
110  NEXT J
120 NEXT I
130 CLS
140 LET SCORE = 0
150 GOSUB 390
160 LET ROW = INT(RND(1)*10) + 1
170 LET COLUMN = INT(RND(1)*10) + 1
180 LET BLOCK = INT(RND(1)*5) + 1
190 GOSUB 270
200 WHILE INKEY$ = ""
210   GOSUB 360
220 WEND
230 IF INKEY$ = "q" THEN END
240 IF ROWCOMPLETE() THEN
250   GOSUB 300
260 ENDIF
270 CLS
280 FOR I = 1 TO 10
290   FOR J = 1 TO 10
300     IF GRID(I,J) = 0 THEN PRINT "."; ELSE PRINT GRID(I,J);
310   NEXT J
320   PRINT
330 NEXT I
340 RETURN
350 END
360 IF INKEY$ = "DOWN" THEN
370  IF ROW < 10 THEN ROW = ROW + 1
380 ENDIF
390 IF INKEY$ = "UP" THEN
400  IF ROW > 1 THEN ROW = ROW - 1
410 ENDIF
420 IF INKEY$ = "RIGHT" THEN
430  IF COLUMN < 10 THEN COLUMN = COLUMN + 1
440 ENDIF
450 IF INKEY$ = "LEFT" THEN
460  IF COLUMN > 1 THEN COLUMN = COLUMN - 1
470 ENDIF
480 IF INKEY$ = " " THEN
490  IF GRID(ROW,COLUMN) = 0 THEN
500    GRID(ROW,COLUMN) = BLOCK
510    LET BLOCK = INT(RND(1)*5) + 1
520  ENDIF
530 ENDIF
540 RETURN
550 END
560 ROWCOMPLETE()
570 FOR I = 1 TO 10
580  LET COMPLETE = 1
590  FOR J = 1 TO 10
600    IF GRID(I,J) = 0 THEN LET COMPLETE = 0
610  NEXT J
620  IF COMPLETE THEN RETURN 1
630 NEXT I
640 RETURN 0
650 END
